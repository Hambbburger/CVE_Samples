/// `file_bytes` must not be NULL
#[export_name = "html_style_block_handler"]
pub unsafe extern "C" fn html_style_block_handler(
    ctx: *mut cli_ctx,
    file_bytes: *const c_char,
) -> cl_error_t {
    let css_input = if file_bytes.is_null() {
        warn!("html css 'file_bytes' buffer is NULL");
        return cl_error_t_CL_ERROR;
    } else {
        #[allow(unused_unsafe)]
        unsafe { CStr::from_ptr(file_bytes) }.to_string_lossy()
    };

    let extractor = if let Ok(extractor) = CssImageExtractor::new(&css_input) {
        extractor
    } else {
        return cl_error_t_CL_ERROR;
    };
    let mut scan_result = cl_error_t_CL_SUCCESS;
    extractor.into_iter().all(|image| {
            debug!("Extracted {}-byte image", image.len());

            let ret = magic_scan(ctx, &image, None);
            if ret != cl_error_t_CL_SUCCESS {
                scan_result = ret;
                return false;
            }
            true
        });
    scan_result
}
